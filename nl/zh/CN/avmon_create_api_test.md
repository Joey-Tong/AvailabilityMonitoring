---

copyright:
  years: 2015, 2017
lastupdated: "2017-11-07"

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:tip: .tip}

# 创建 REST API 测试
{: #avmon_rest_api}

使用以下 HTTP 方法，创建 REST API 测试，以测试 Web 应用程序的响应时间和可用性：GET、POST、PUT 和 DELETE。
{: shortdesc}

使用 REST API 测试，可监视 Web 应用程序和其他 URL 在响应 REST 调用时的可用性和性能。

要创建 REST API 测试，请完成以下步骤：

1.  如果您正在查看 Cloud Foundry 应用程序的**监视**选项卡，请单击**添加新测试**。

    ![Cloud Foundry 应用程序的“监视”选项卡。](images/avmon_tab.png)

    如果您正在查看 {{site.data.keyword.prf_hubshort}} 仪表板，请单击“合成测试”窗格上的**添加新测试**。

    ![“合成测试”窗格上的“添加新测试”按钮。](images/syn_tests_pane.jpg)

2.  单击“监视设置”页面上的**单个操作**，然后单击“单个操作”页面上的 **REST API**。
3.  在**名称**字段中为测试输入有意义的名称。在**描述**字段中添加测试目的的描述。
4.  在“请求”部分中，从**方法**列表中选择方法的类型，并输入要使用此方法进行测试的 **URL**。您可以选择 **GET**、**PUT**、**POST** 或 **DELETE**。如果选择 PUT 或 POST 方法，那么您可以在**请求主体（可选）**字段中输入要测试的主体内容。

    例如，以下 REST API 测试使用 POST 方法，除了测试 Web 应用程序的可用性和性能之外，还请求该 Web 应用程序接受数据。

    ![使用 POST 请求方法的 REST API 测试的示例。](images/avmon_restapi_post.png)

5.  您可以配置测试以包含特定头和值。在**头**字段中输入头名称和头值。

    如果要测试的 Web 应用程序需要用户登录名和密码，请在**头名称**字段中输入“Authorization”。在**头值**字段中输入单词“Basic”、空格字符和 username:password 的 Base64 编码值。

    例如，如果用户名为 Aladdin 且密码为 OpenSesame，那么在**头值**字段中输入单词“Basic”、空格字符和 Aladdin:OpenSesame 的 Base64 编码值。

    ![描述 Base64 编码的测试授权凭证的头字段。](images/avmon_apitest_auth.png)

6.  在“响应验证”部分中，为测试配置警告和严重警报阈值。编辑每一行的**值**和**单位**。超过警告和严重阈值的响应时间会触发警报。

    ![具有缺省“警告”和“严重”阈值的“响应验证”部分。](images/avmon_restapi_resp_val.png)

7.  单击**添加条件**以定义并添加定制响应验证条件。定制响应验证条件归结在一起进行评估以生成警报。您最多可以为测试定义并添加六个定制条件。

    在 {{site.data.keyword.prf_hubshort}} 中，每个测试最多可生成三个警报。测试会报告严重性最高的警报，直到所有导致警报的条件都得到解决。有关更多信息，请参阅 [Availability Monitoring 中的警报生成](avmon_alert_desc.html "在 Availability Monitoring 中，测试最多可生成总计三个警报。测试会报告严重性最高的警报，直到导致警报的条件得到解决。")
    {: tip}

    您可以验证以下数据：

    - **头响应代码**。选择**头响应代码**以针对一个或一系列 HTTP 响应代码进行测试。
    - **头属性**。选择**头属性**以针对特定 HTTP 头字段属性和值进行测试。
    - **主体 JSON**。选择**主体 json** 以针对 JSON 主体的特定属性进行测试。

      对于每个条件，在**目标**字段中输入要测试的属性，在**值**字段中输入要测试的值。从**操作**下拉菜单中选择操作程序。最后，为条件选择警报严重性**警告**或**严重**。

    缺省情况下，在**值**字段中输入的数字值会被视为数字而不是字符串。当为响应验证条件输入**值**时，请使用引号 "" 区分字符串和数字。例如，要测试字符串 123，请在“值”字段中输入“123”。要检查数字 400，请不带任何引号输入 400。
    {: tip}

    ![REST API 测试的响应验证条件。](images/avmon_restapi_resp_val2.png)

8.  单击**验证**以创建 REST API 测试并确定测试请求是否有效。

    {{site.data.keyword.prf_hubshort}} 通过所选择的 HTTP 方法和您为测试所定义的任何请求头，来确定测试的有效性。在测试验证期间，不会发生响应验证。

    经验证的测试将显示在“已验证的项”表中。 您可以重复步骤 3 至 8 来添加更多 URL。

9.  要配置测试设置，请单击“下一步”。

    此时将显示测试配置的摘要。例如，这将针对缺省设置显示以下消息：

    ``将进行测试：同时从 3 个位置每 15 分钟进行一次测试，以确定测试是否超过指定阈值。``

    每月估计的使用情况和估计的测试数将基于当前测试配置显示。

10. 在“设置”窗格中，单击**编辑**以显示测试的当前设置。

    您可以更改测试的时间间隔、测试频率以及发送测试的位置。

    ![显示测试的缺省设置的“测试设置”窗格。](images/avmon_settings.png)

    选择**同时**可从所有位置同时运行测试；选择**交错**可在每个时间间隔后从选定的不同位置运行测试。单击**保存**以完成测试配置。

11. 单击**完成**。{{site.data.keyword.prf_hubshort}} 仪表板显示了所有测试的摘要、用于显示警报严重性和位置的图和表、与应用程序相关联的所有合成测试、包含活动的表，以及描述应用程序和其他 Web 站点的响应时间和可用性的折线图。
